<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RF工程师的AI实战指南：TSMC 65n 差分变压器建模</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Alpine.js for Interactivity -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Prism.js for Syntax Highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

    <!-- Icons -->
    <script src="https://unpkg.com/phosphor-icons"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        rf: {
                            base: '#0f172a', // Slate 900
                            card: '#1e293b', // Slate 800
                            accent: '#38bdf8', // Sky 400
                            secondary: '#6366f1', // Indigo 500
                            success: '#10b981',
                            warning: '#f59e0b',
                            danger: '#ef4444'
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a; 
        }
        ::-webkit-scrollbar-thumb {
            background: #334155; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #475569; 
        }
        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>
</head>
<body class="bg-rf-base text-slate-300 font-sans antialiased selection:bg-rf-accent selection:text-rf-base">

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-panel border-b border-slate-700/50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-2">
                    <i class="ph-bold ph-circuitry text-rf-accent text-2xl"></i>
                    <span class="font-bold text-white text-lg tracking-tight">RF<span class="text-rf-accent">.AI</span> Lab</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#intro" class="hover:text-rf-accent px-3 py-2 rounded-md text-sm font-medium transition-colors">思维转换</a>
                        <a href="#models" class="hover:text-rf-accent px-3 py-2 rounded-md text-sm font-medium transition-colors">模型选择</a>
                        <a href="#training" class="hover:text-rf-accent px-3 py-2 rounded-md text-sm font-medium transition-colors">训练诊断</a>
                        <a href="#tuning" class="hover:text-rf-accent px-3 py-2 rounded-md text-sm font-medium transition-colors">调参优化</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="intro" class="pt-32 pb-20 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto">
        <div class="text-center mb-16">
            <span class="inline-block py-1 px-3 rounded-full bg-rf-accent/10 text-rf-accent text-xs font-semibold tracking-wider mb-4 border border-rf-accent/20">TSMC 65n 差分变压器实战</span>
            <h1 class="text-4xl md:text-6xl font-extrabold text-white mb-6 leading-tight">
                从 <span class="text-transparent bg-clip-text bg-gradient-to-r from-rf-accent to-rf-secondary">Smith Chart</span> 到 <br>
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-rf-secondary to-purple-400">Gradient Descent</span>
            </h1>
            <p class="max-w-2xl mx-auto text-lg text-slate-400">
                面向射频工程师的机器学习教程。我们将使用已生成的 Geo+Freq 数据集，构建能够替代 EMX 仿真的秒级 S 参数预测模型。
            </p>
        </div>

        <!-- Interactive Concept Mapping -->
        <div x-data="{ 
            active: 'schematic',
            items: {
                schematic: { rf: '电路原理图 (Schematic)', ai: '模型架构 (Model Architecture)', desc: '决定了系统的连接方式和基本能力。' },
                params: { rf: '器件参数 (W, L, S)', ai: '权重与偏置 (Weights & Biases)', desc: '模型内部需要被优化/求解的数值。' },
                setup: { rf: '仿真器设置 (Simulation Setup)', ai: '超参数 (Hyperparameters)', desc: '人为设定的配置，如学习率、层数。' },
                goal: { rf: '优化目标 (Optimization Goal)', ai: '损失函数 (Loss Function)', desc: '衡量当前结果与理想结果差距的标尺。' },
                corner: { rf: 'PVT Corner 验证', ai: '验证集/测试集 (Validation/Test)', desc: '测试系统在未见过的情况下的表现。' }
            }
        }" class="bg-rf-card rounded-2xl border border-slate-700/50 p-1 shadow-2xl max-w-4xl mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-0 md:divide-x divide-slate-700">
                <!-- Left: RF World -->
                <div class="p-6">
                    <h3 class="text-rf-accent font-bold mb-4 flex items-center gap-2"><i class="ph-bold ph-wave-sine"></i> RF 领域概念</h3>
                    <div class="space-y-2">
                        <template x-for="(val, key) in items">
                            <button @mouseenter="active = key" 
                                    :class="active === key ? 'bg-slate-700 border-rf-accent text-white' : 'border-transparent text-slate-400 hover:bg-slate-800'"
                                    class="w-full text-left px-4 py-3 rounded-lg border-l-4 transition-all duration-200 text-sm font-medium"
                                    x-text="val.rf"></button>
                        </template>
                    </div>
                </div>
                <!-- Right: AI World -->
                <div class="p-6 flex flex-col justify-center bg-gradient-to-br from-rf-card to-slate-800/50">
                    <h3 class="text-rf-secondary font-bold mb-4 flex items-center gap-2"><i class="ph-bold ph-brain"></i> AI 对应概念</h3>
                    <div class="h-32 flex flex-col justify-center">
                        <div class="text-xl font-bold text-white mb-2" x-text="items[active].ai"></div>
                        <p class="text-slate-400 text-sm leading-relaxed" x-text="items[active].desc"></p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Model Selection Section -->
    <section id="models" class="py-20 bg-slate-800/30">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-white mb-2">1. 基线模型选择</h2>
            <p class="text-slate-400 mb-10">无需“杀鸡用牛刀”。根据数据结构和物理需求选择架构。</p>

            <div x-data="{ tab: 'xgboost' }" class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Tabs List -->
                <div class="lg:col-span-1 space-y-4">
                    <button @click="tab = 'xgboost'" 
                            :class="tab === 'xgboost' ? 'ring-2 ring-rf-accent bg-rf-card' : 'bg-rf-card/50 hover:bg-rf-card'"
                            class="w-full text-left p-6 rounded-xl transition-all duration-200 group relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-rf-success"></div>
                        <h3 class="text-white font-bold text-lg mb-1 group-hover:text-rf-accent transition-colors">XGBoost</h3>
                        <p class="text-slate-400 text-sm">经典机器学习代表</p>
                    </button>

                    <button @click="tab = 'mlp'" 
                            :class="tab === 'mlp' ? 'ring-2 ring-rf-secondary bg-rf-card' : 'bg-rf-card/50 hover:bg-rf-card'"
                            class="w-full text-left p-6 rounded-xl transition-all duration-200 group relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-rf-secondary"></div>
                        <h3 class="text-white font-bold text-lg mb-1 group-hover:text-rf-secondary transition-colors">MLP (神经网络)</h3>
                        <p class="text-slate-400 text-sm">物理信息建模首选</p>
                    </button>

                    <button @click="tab = 'others'" 
                            :class="tab === 'others' ? 'ring-2 ring-purple-500 bg-rf-card' : 'bg-rf-card/50 hover:bg-rf-card'"
                            class="w-full text-left p-6 rounded-xl transition-all duration-200 group relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-purple-500"></div>
                        <h3 class="text-white font-bold text-lg mb-1 group-hover:text-purple-400 transition-colors">CNN / Transformer</h3>
                        <p class="text-slate-400 text-sm">高级架构</p>
                    </button>
                </div>

                <!-- Tab Content -->
                <div class="lg:col-span-2 bg-rf-card rounded-2xl border border-slate-700/50 p-8 relative min-h-[400px]">
                    
                    <!-- XGBoost Content -->
                    <div x-show="tab === 'xgboost'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-2" x-transition:enter-end="opacity-100 translate-y-0">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-2xl font-bold text-white">Gradient Boosting Trees</h3>
                            <span class="px-3 py-1 bg-rf-success/20 text-rf-success text-xs rounded-full border border-rf-success/30">Baseline 首选</span>
                        </div>
                        <p class="text-slate-300 mb-6 leading-relaxed">
                            XGBoost 类似于成千上万个“查找表”的加权组合。它非常适合处理这种表格型数据（几何参数 → S参数）。
                        </p>
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="bg-slate-900/50 p-4 rounded-lg">
                                <h4 class="text-rf-success font-bold text-sm mb-2"><i class="ph-bold ph-check-circle"></i> 优点</h4>
                                <ul class="text-sm text-slate-400 space-y-1 list-disc list-inside">
                                    <li>训练快 </li>
                                    <li>对特征归一化不敏感</li>
                                    <li>可输出特征重要性排序</li>
                                </ul>
                            </div>
                            <div class="bg-slate-900/50 p-4 rounded-lg">
                                <h4 class="text-rf-danger font-bold text-sm mb-2"><i class="ph-bold ph-x-circle"></i> 缺点</h4>
                                <ul class="text-sm text-slate-400 space-y-1 list-disc list-inside">
                                    <li><b>不可微</b>（致命弱点）</li>
                                    <li>无法嵌入物理公式 (Q=Im/Re)</li>
                                    <li>外推能力较差</li>
                                </ul>
                            </div>
                        </div>
                        <div class="bg-slate-900 p-4 rounded-lg border border-slate-700">
                            <code class="text-xs text-rf-accent font-mono">train_xgboost.py</code>
                            <p class="text-sm text-slate-400 mt-2">使用此脚本快速验证数据质量。如果 XGBoost 效果很差，通常意味着数据本身有问题，而非模型问题。</p>
                        </div>

                        <!-- Additional classic ML models: Random Forest, SVM, KNN -->
                        <div class="mt-4 grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <div class="bg-slate-900/60 p-4 rounded-lg border border-slate-700/50">
                                <h4 class="text-sm font-bold text-white mb-1">Random Forest</h4>
                                <p class="text-xs text-slate-400 mb-2">基于决策树的集成方法，通过随机采样和特征子集创建多棵树并取平均/投票。</p>
                                <ul class="text-xs text-slate-400 list-disc list-inside">
                                    <li>优点：鲁棒、对异常值与缺失值容错强</li>
                                    <li>缺点：可解释性低、对高维稀疏特征不友好</li>
                                </ul>
                                <div class="mt-2 text-xs text-slate-500 font-mono">train_rf.py</div>
                            </div>

                            <div class="bg-slate-900/60 p-4 rounded-lg border border-slate-700/50">
                                <h4 class="text-sm font-bold text-white mb-1">Support Vector Machine (SVM)</h4>
                                <p class="text-xs text-slate-400 mb-2">通过在高维空间寻找最大间隔超平面来分类或回归（SVR）。适合小样本、低噪声数据。</p>
                                <ul class="text-xs text-slate-400 list-disc list-inside">
                                    <li>优点：对高维空间有理论保证，能处理非线性核</li>
                                    <li>缺点：对大规模数据和噪声敏感，调参（核、C、gamma）复杂</li>
                                </ul>
                                <div class="mt-2 text-xs text-slate-500 font-mono">train_svm.py</div>
                            </div>

                            <div class="bg-slate-900/60 p-4 rounded-lg border border-slate-700/50">
                                <h4 class="text-sm font-bold text-white mb-1">K-Nearest Neighbors (KNN)</h4>
                                <p class="text-xs text-slate-400 mb-2">基于距离度量的非参数方法，直接使用训练数据进行预测（懒惰学习）。</p>
                                <ul class="text-xs text-slate-400 list-disc list-inside">
                                    <li>优点：实现简单，不需要训练阶段</li>
                                    <li>缺点：查询慢、对数据尺度敏感、内存占用高</li>
                                </ul>
                                <div class="mt-2 text-xs text-slate-500 font-mono">train_knn.py</div>
                            </div>
                        </div>
                    </div>

                    <!-- MLP Content -->
                    <div x-show="tab === 'mlp'" x-cloak x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-2" x-transition:enter-end="opacity-100 translate-y-0">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-2xl font-bold text-white">Multi-Layer Perceptron</h3>
                            <span class="px-3 py-1 bg-rf-secondary/20 text-rf-secondary text-xs rounded-full border border-rf-secondary/30">物理建模核心</span>
                        </div>
                        <p class="text-slate-300 mb-6 leading-relaxed">
                            全连接神经网络。虽然结构简单，但它的核心在于<b>可微分性 (Differentiability)</b>。这意味着我们可以将 Q 值公式写入 Loss Function。
                        </p>
                        <div class="mb-6 bg-gradient-to-r from-slate-900 to-slate-800 p-5 rounded-lg border-l-4 border-rf-secondary">
                            <div class="text-xs text-slate-500 mb-1 uppercase tracking-widest font-bold">Physics-Informed Loss</div>
                            <div class="font-mono text-sm text-slate-200">
                                $$ Loss = w_s \cdot MSE(S) + w_{kpi} \cdot MSE(KPI(S)) $$
                            </div>
                            <p class="text-xs text-slate-400 mt-2">模型被迫不仅拟合 S 参数曲线，还要拟合其导数特性（Q值），从而解决传统 AI 模型 Q 值预测不准的痛点。</p>
                        </div>
                        <div class="bg-slate-900 p-4 rounded-lg border border-slate-700">
                            <code class="text-xs text-rf-secondary font-mono">model.py (SimpleMLP)</code>
                            <p class="text-sm text-slate-400 mt-2">推荐作为最终交付模型，因为其极易导出并在电路仿真环境中部署。</p>
                        </div>
                    </div>

                    <!-- Others Content -->
                    <div x-show="tab === 'others'" x-cloak x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-2" x-transition:enter-end="opacity-100 translate-y-0">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-2xl font-bold text-white">CNN & Transformer</h3>
                        </div>
                        <div class="space-y-4">
                            <div class="border-b border-slate-700 pb-4">
                                <h4 class="text-purple-400 font-bold mb-1">CNN (卷积神经网络)</h4>
                                <p class="text-sm text-slate-400">
                                    <span class="text-white">适用场景：</span> 如果输入是 GDSII 版图图像（像素级），而非提取好的 L/W/S 参数。
                                </p>
                            </div>
                            <div>
                                <h4 class="text-purple-400 font-bold mb-1">Transformer</h4>
                                <p class="text-sm text-slate-400">
                                    <span class="text-white">适用场景：</span> 处理序列数据。如果我们需要一次性预测整个宽频带的响应（序列到序列），而非逐频点预测，可以考虑 Transformer。但在当前 Geo+Freq → S 的任务中，由于数据结构简单，Transformer 往往性价比不高（过拟合风险大，训练慢）。
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Training Dynamics Section -->
    <!-- Training Dynamics Section (Refined) -->
    <section id="training" class="py-20 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="mb-12">
            <h2 class="text-3xl font-bold text-white mb-4">2. 训练诊断：模型“不收敛”怎么办？</h2>
            <p class="text-lg text-slate-400 max-w-3xl">
                如同电路仿真会遇到由步长设置或模型参数引起的“不收敛”一样，模型训练也有它的典型病态。
                我们需要像调试电路一样调试模型。
            </p>
        </div>

        <div class="space-y-12">
            
            <!-- 1. Overfitting vs Underfitting -->
            <div class="bg-rf-card rounded-2xl border border-slate-700 overflow-hidden">
                <div class="px-6 py-4 border-b border-slate-700 bg-slate-800/50 flex items-center gap-2">
                    <i class="ph-bold ph-scales text-rf-accent text-xl"></i>
                    <h3 class="text-xl font-bold text-white">1. 过拟合 (Overfitting) vs. 欠拟合 (Underfitting)</h3>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-slate-700">
                    
                    <!-- Underfitting -->
                    <div class="p-8 hover:bg-slate-800/30 transition-colors">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="px-2 py-1 bg-yellow-500/10 text-yellow-500 text-xs font-bold rounded uppercase border border-yellow-500/20">Underfitting</span>
                            <span class="text-slate-500 text-sm">模型太简单</span>
                        </div>
                        <div class="mb-6">
                            <h4 class="text-sm font-bold text-slate-300 uppercase tracking-wider mb-2">RF 视角类比</h4>
                            <p class="text-slate-400 text-sm leading-relaxed">
                                就像用 <span class="text-white font-medium">一阶多项式</span> 去拟合一个复杂的 <span class="text-white font-medium">LC 谐振曲线</span>。模型容量不足，根本抓不住谐振峰和带宽特征。
                            </p>
                        </div>
                        <div class="bg-slate-900/80 rounded-lg p-4 border border-slate-700/50">
                            <div class="flex justify-between text-sm mb-1">
                                <span class="text-slate-500">Train Loss</span>
                                <span class="text-red-400 font-mono">High ↑</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-slate-500">Val Loss</span>
                                <span class="text-red-400 font-mono">High ↑</span>
                            </div>
                        </div>
                    </div>

                    <!-- Overfitting -->
                    <div class="p-8 hover:bg-slate-800/30 transition-colors">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="px-2 py-1 bg-red-500/10 text-red-500 text-xs font-bold rounded uppercase border border-red-500/20">Overfitting</span>
                            <span class="text-slate-500 text-sm">死记硬背</span>
                        </div>
                        <div class="mb-6">
                            <h4 class="text-sm font-bold text-slate-300 uppercase tracking-wider mb-2">RF 视角类比</h4>
                            <p class="text-slate-400 text-sm leading-relaxed">
                                就像用 <span class="text-white font-medium">100阶多项式</span> 拟合曲线。它把仿真产生的 <span class="text-white font-medium">数值噪声 (Mesh Noise)</span> 都拟合进去了，导致在平滑频段出现非物理的震荡。
                            </p>
                        </div>
                        <div class="bg-slate-900/80 rounded-lg p-4 border border-slate-700/50">
                            <div class="flex justify-between text-sm mb-1">
                                <span class="text-slate-500">Train Loss</span>
                                <span class="text-emerald-400 font-mono">Low ↓</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-slate-500">Val Loss</span>
                                <span class="text-red-400 font-mono">High ↑ (泛化差)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Solutions Bar -->
                <div class="px-8 py-6 bg-slate-800/80 border-t border-slate-700 flex flex-col md:flex-row gap-6">
                    <div class="flex-1 flex gap-3">
                        <i class="ph-bold ph-toggle-left text-rf-secondary text-2xl mt-1"></i>
                        <div>
                            <span class="text-white font-bold block text-sm">Dropout</span>
                            <span class="text-xs text-slate-500 font-mono mb-1 block">model.py</span>
                            <p class="text-xs text-slate-400">训练时随机“关掉”一部分神经元，防止模型依赖特定路径。</p>
                        </div>
                    </div>
                    <div class="flex-1 flex gap-3">
                        <i class="ph-bold ph-hand-palm text-rf-secondary text-2xl mt-1"></i>
                        <div>
                            <span class="text-white font-bold block text-sm">Early Stopping</span>
                            <span class="text-xs text-slate-500 font-mono mb-1 block">train_nn.py</span>
                            <p class="text-xs text-slate-400">发现验证集 Loss 不再下降时，提前终止训练（类似电路优化的 Stop Criteria）。</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 2. Gradient Problems -->
            <div class="relative group">
                <!-- Glowing effect -->
                <div class="absolute -inset-0.5 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-2xl opacity-20 group-hover:opacity-40 transition duration-500 blur"></div>
                
                <div class="relative bg-rf-card rounded-2xl border border-slate-700 p-8">
                    <div class="flex flex-col lg:flex-row gap-8">
                        
                        <!-- Left: Concept -->
                        <div class="lg:w-1/2 space-y-6">
                            <div class="flex items-center gap-3">
                                <div class="p-2 bg-purple-500/10 rounded-lg text-purple-400">
                                    <i class="ph-bold ph-lightning text-2xl"></i>
                                </div>
                                <h3 class="text-xl font-bold text-white">2. 梯度消失与爆炸 (Vanishing/Exploding)</h3>
                            </div>
                            
                            <p class="text-slate-400 leading-relaxed">
                                这是神经网络反向传播特有的问题。误差需要通过链式法则一层层传回输入端。
                            </p>
                            
                            <div class="bg-slate-900/50 rounded-xl p-5 border-l-4 border-purple-500">
                                <h4 class="text-sm font-bold text-white mb-2">RF 视角类比：多级级联放大器</h4>
                                <ul class="space-y-2 text-sm text-slate-400">
                                    <li class="flex items-start gap-2">
                                        <i class="ph-fill ph-caret-right text-slate-600 mt-1"></i>
                                        <span><strong class="text-slate-300">梯度消失：</strong>如果每一级增益都 &lt; 1，信号传到最后就淹没在底噪中了。</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="ph-fill ph-caret-right text-slate-600 mt-1"></i>
                                        <span><strong class="text-slate-300">梯度爆炸：</strong>如果每一级增益都很大，信号很快就会饱和/削波 (Clipping)。</span>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- Right: Project Specifics -->
                        <div class="lg:w-1/2 bg-slate-900 rounded-xl p-6 border border-slate-700/50">
                            <h4 class="text-rf-accent font-bold mb-4 text-sm uppercase tracking-wider">本项目中的特殊挑战：Q 值奇点</h4>
                            
                            <div class="flex items-center justify-center py-4 mb-4 bg-slate-800 rounded-lg">
                                <span class="text-xl text-white font-serif italic">Q = Im(Z) / Re(Z)</span>
                            </div>

                            <p class="text-sm text-slate-400 mb-6 leading-relaxed">
                                在自谐振频率 (SRF) 附近，<span class="font-serif italic text-white">Re(Z)</span> 趋近于 0。这导致 Q 值趋向无穷大 ($\infty$)。
                                此时计算出的梯度数值极大，如果不加控制，会瞬间“摧毁”模型的权重矩阵，导致 Loss 变成 NaN。
                            </p>

                            <div class="space-y-3">
                                <div class="flex items-center gap-3 text-sm">
                                    <i class="ph-bold ph-check text-green-500"></i>
                                    <span class="text-slate-300 font-mono">Gradient Clamping</span>
                                    <span class="text-slate-500">- 限制梯度最大模长 (类似限幅器)</span>
                                </div>
                                <div class="flex items-center gap-3 text-sm">
                                    <i class="ph-bold ph-check text-green-500"></i>
                                    <span class="text-slate-300 font-mono">Log-MSE</span>
                                    <span class="text-slate-500">- 在 Log 域计算 Q 误差，压缩数值范围</span>
                                </div>
                                <div class="mt-4 pt-4 border-t border-slate-800 text-xs text-slate-500 font-mono text-right">
                                    相关文件: loss_functions.py
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <!-- Tuning Section -->
    <!-- Tuning Section (Refined) -->
    <section id="tuning" class="py-20 bg-slate-900/50 border-t border-slate-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            
            <!-- Header -->
            <div class="mb-12">
                <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                    <div>
                        <h2 class="text-3xl font-bold text-white mb-4">3. 调参优化：寻找“最佳工作点”</h2>
                        <p class="text-lg text-slate-400 max-w-3xl">
                            模型结构确定后，性能的上限取决于超参数 (Hyperparameters)。这与在 EDA 软件中设定 <span class="text-rf-accent font-mono">Variables</span> 并进行 <span class="text-rf-accent font-mono">Optimization</span> 的过程完全一致。
                        </p>
                    </div>
                    <div class="flex items-center gap-3 bg-slate-800 px-4 py-2 rounded-lg border border-slate-700">
                        <i class="ph-bold ph-file-code text-rf-secondary"></i>
                        <span class="text-sm font-mono text-slate-300">tune_nn.py</span>
                    </div>
                </div>
            </div>

            <!-- Methods Comparison Grid -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-16">
                
                <!-- Grid Search -->
                <div class="group bg-rf-card p-6 rounded-xl border border-slate-700 hover:border-slate-500 transition-colors">
                    <div class="mb-4 text-slate-500 group-hover:text-white transition-colors">
                        <i class="ph-bold ph-grid-four text-3xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-white mb-2">Grid Search (网格搜索)</h3>
                    <p class="text-sm text-slate-400 mb-4 h-10">
                        类似于 EDA 中的 <span class="text-white">Parameter Sweep</span>。设定步长，穷举所有组合。
                    </p>
                    <div class="space-y-2 text-xs">
                        <div class="flex justify-between border-b border-slate-700 pb-1">
                            <span class="text-slate-500">原理</span>
                            <span class="text-slate-300">遍历全空间</span>
                        </div>
                        <div class="flex justify-between border-b border-slate-700 pb-1">
                            <span class="text-slate-500">效率</span>
                            <span class="text-rf-danger">低 (指数爆炸)</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-500">适用</span>
                            <span class="text-slate-300">参数极少时</span>
                        </div>
                    </div>
                </div>

                <!-- Random Search -->
                <div class="group bg-rf-card p-6 rounded-xl border border-slate-700 hover:border-slate-500 transition-colors">
                    <div class="mb-4 text-slate-500 group-hover:text-white transition-colors">
                        <i class="ph-bold ph-shuffle text-3xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-white mb-2">Random Search (随机搜索)</h3>
                    <p class="text-sm text-slate-400 mb-4 h-10">
                        在参数空间内随机采样。比网格搜索更容易“撞”到最优解附近。
                    </p>
                    <div class="space-y-2 text-xs">
                        <div class="flex justify-between border-b border-slate-700 pb-1">
                            <span class="text-slate-500">原理</span>
                            <span class="text-slate-300">蒙特卡洛采样</span>
                        </div>
                        <div class="flex justify-between border-b border-slate-700 pb-1">
                            <span class="text-slate-500">效率</span>
                            <span class="text-rf-warning">中等</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-500">适用</span>
                            <span class="text-slate-300">基准测试</span>
                        </div>
                    </div>
                </div>

                <!-- Bayesian Optimization -->
                <div class="group bg-rf-card p-6 rounded-xl border border-rf-secondary/50 shadow-[0_0_20px_rgba(99,102,241,0.1)] relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-2">
                        <span class="px-2 py-1 bg-rf-secondary text-white text-[10px] font-bold uppercase rounded">推荐</span>
                    </div>
                    <div class="mb-4 text-rf-secondary">
                        <i class="ph-bold ph-brain text-3xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-white mb-2">Bayesian Optimization</h3>
                    <p class="text-sm text-slate-400 mb-4 h-10">
                        <span class="text-white font-bold">智能搜索</span>。根据历史实验结果，推断哪里最可能出现更优解。这是 <span class="font-bold text-rf-secondary">Optuna</span> 的核心。
                    </p>
                    <div class="space-y-2 text-xs">
                        <div class="flex justify-between border-b border-slate-700 pb-1">
                            <span class="text-slate-500">原理</span>
                            <span class="text-slate-300">高斯过程/TPE</span>
                        </div>
                        <div class="flex justify-between border-b border-slate-700 pb-1">
                            <span class="text-slate-500">效率</span>
                            <span class="text-rf-success">极高</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-500">适用</span>
                            <span class="text-slate-300">高维参数调优</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Deep Dive: Optuna & WandB -->
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                
                <!-- Optuna Code Logic (Left - 7 cols) -->
                <div class="lg:col-span-7 space-y-6">
                    <div class="flex items-center gap-2 mb-2">
                        <img src="https://raw.githubusercontent.com/optuna/optuna/master/docs/image/optuna-logo.png" class="h-6 opacity-80" alt="Optuna">
                        <h3 class="text-xl font-bold text-white">Optuna 实战解析</h3>
                    </div>
                    <p class="text-sm text-slate-400 mb-4">Optuna 仪表盘（本地/远程）示例：
                        <a href="http://10.0.0.61:8557" target="_blank" rel="noopener" class="text-rf-accent underline">http://10.0.0.61:8557</a>
                    </p>
                    
                    <div class="bg-slate-900 rounded-lg border border-slate-700 overflow-hidden shadow-2xl">
                        <div class="flex items-center justify-between px-4 py-2 bg-slate-800 border-b border-slate-700">
                            <span class="text-xs text-slate-400 font-mono">tune_nn.py :: objective()</span>
                        </div>
                        <div class="p-4 overflow-x-auto">
<pre class="text-sm font-mono leading-relaxed"><code class="language-python">def objective(trial):
    # --- 1. 定义搜索空间 (类似于设置 Variable Range) ---
    # Log 均匀分布：适合跨数量级的参数（如学习率）
    lr = trial.suggest_float("lr", 1e-5, 1e-2, log=True)
    
    # 整数分布：适合层数、神经元数量
    n_layers = trial.suggest_int("n_layers", 3, 6)
    
    # --- 2. 关键：Loss 权重平衡 ---
    # 我们不仅调模型，还要调"物理公式"的权重
    w_kpi = trial.suggest_float("w_kpi", 0.0, 1.0)
    
    # --- 3. 训练与剪枝 (Pruning) ---
    model = SimpleMLP(..., hidden_dims=[64]*n_layers)
    
    for epoch in range(100):
        val_loss = train_epoch(...)
        
        # 汇报进度
        trial.report(val_loss, epoch)
        
        # 如果发现这组参数在前期效果就极差
        # 直接终止，节省时间 (类似电路仿真的 Stop Criteria)
        if trial.should_prune():
            raise optuna.TrialPruned()

    return val_loss</code></pre>
                        </div>
                    </div>
                    
                    <!-- Cheat Sheet -->
                    <div class="bg-rf-card/50 border border-slate-700/50 rounded-xl p-5">
                        <h4 class="text-sm font-bold text-white mb-3 flex items-center gap-2">
                            <i class="ph-bold ph-list-magnifying-glass text-rf-accent"></i>
                            实战：RF 建模应该调什么？
                        </h4>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm">
                            <div class="flex justify-between items-center border-b border-slate-700/50 pb-2">
                                <span class="text-slate-400">Learning Rate</span>
                                <span class="font-mono text-rf-accent">1e-4 ~ 1e-2</span>
                            </div>
                            <div class="flex justify-between items-center border-b border-slate-700/50 pb-2">
                                <span class="text-slate-400">Batch Size</span>
                                <span class="font-mono text-rf-accent">32 ~ 1024</span>
                            </div>
                            <div class="flex justify-between items-center border-b border-slate-700/50 pb-2">
                                <span class="text-slate-400">Hidden Layers</span>
                                <span class="font-mono text-rf-accent">3 ~ 8 层</span>
                            </div>
                            <div class="flex justify-between items-center border-b border-slate-700/50 pb-2">
                                <span class="text-slate-400">KPI Loss Weight</span>
                                <span class="font-mono text-rf-accent">0.1 ~ 5.0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- WandB Visualization (Right - 5 cols) -->
                <div class="lg:col-span-5 flex flex-col">
                    <div class="flex items-center gap-2 mb-2">
                        <img src="https://raw.githubusercontent.com/wandb/assets/main/wandb-logo-yellow-dots-black-wb.svg" class="h-6 opacity-80" alt="WandB">
                        <h3 class="text-xl font-bold text-white">WandB 可视化</h3>
                    </div>
                    
                    <div class="flex-grow bg-slate-900 rounded-xl border border-slate-700 p-6 flex flex-col justify-between relative overflow-hidden group">
                        <!-- Abstract Representation of Parallel Coordinates Plot -->
                        <div class="absolute inset-0 opacity-10 group-hover:opacity-20 transition-opacity">
                             <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                                <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
                                  <path d="M 20 0 L 0 0 0 20" fill="none" stroke="white" stroke-width="0.5"/>
                                </pattern>
                                <rect width="100%" height="100%" fill="url(#grid)" />
                              </svg>
                        </div>

                        <div class="relative z-10">
                            <h4 class="text-rf-secondary font-bold mb-2">平行坐标图 (Parallel Coordinates)</h4>
                            <p class="text-sm text-slate-400 mb-6">
                                WandB 最强大的功能。它能直观展示高维参数之间的关系。
                                <br>
                                示例项目与可视化示例：
                                <a href="https://wandb.ai/yxiaohan/inductor-model" target="_blank" rel="noopener" class="text-rf-accent underline">https://wandb.ai/yxiaohan/inductor-model</a>
                            </p>
                            
                            <!-- Mock Chart -->
                            <div class="space-y-3">
                                <div class="flex justify-between text-xs text-slate-500 font-mono uppercase">
                                    <span>LR</span>
                                    <span>Layers</span>
                                    <span>Batch</span>
                                    <span>Loss</span>
                                </div>
                                <!-- Lines representing trials -->
                                <div class="relative h-24 w-full">
                                    <!-- Bad Trial -->
                                    <svg class="absolute inset-0 w-full h-full" preserveAspectRatio="none">
                                        <polyline points="0,80 100,20 200,90 300,10" fill="none" stroke="#ef4444" stroke-width="2" stroke-opacity="0.5" />
                                    </svg>
                                    <!-- Good Trial -->
                                    <svg class="absolute inset-0 w-full h-full" preserveAspectRatio="none">
                                        <polyline points="0,50 100,50 200,40 300,90" fill="none" stroke="#10b981" stroke-width="2" />
                                    </svg>
                                    <!-- Average Trials -->
                                    <svg class="absolute inset-0 w-full h-full" preserveAspectRatio="none">
                                        <polyline points="0,60 100,40 200,60 300,50" fill="none" stroke="#64748b" stroke-width="1" stroke-opacity="0.3" />
                                        <polyline points="0,30 100,70 200,20 300,60" fill="none" stroke="#64748b" stroke-width="1" stroke-opacity="0.3" />
                                    </svg>
                                </div>
                                <div class="flex justify-between text-xs font-mono">
                                    <span class="text-rf-danger">发散</span>
                                    <span class="text-rf-success">收敛</span>
                                </div>
                            </div>
                        </div>

                        <div class="relative z-10 mt-6 pt-6 border-t border-slate-800">
                            <p class="text-xs text-slate-400">
                                <i class="ph-bold ph-lightbulb text-yellow-500 mr-1"></i>
                                <span class="text-white font-semibold">Insight:</span> 
                                通过此图可以一眼看出：“当学习率 > 0.005 时，模型很难收敛（红线区域）”。
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-rf-base border-t border-slate-800 pt-12 pb-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="flex justify-center items-center gap-2 mb-4 text-slate-500">
                <i class="ph-bold ph-code"></i>
                <span>Generated for RF Engineering AI Tutorial</span>
            </div>
            <p class="text-slate-600 text-sm">
                &copy; 2023 RF.AI Lab. 基于 TSMC 65n 工艺数据。
            </p>
        </div>
    </footer>

    <!-- Init Prism -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>